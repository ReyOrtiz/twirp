<!DOCTYPE html><html lang="en"><head><meta charSet="utf-8"/><meta http-equiv="X-UA-Compatible" content="IE=edge"/><title>Meet Twirp! · Twirp</title><meta name="viewport" content="width=device-width, initial-scale=1.0"/><meta name="generator" content="Docusaurus"/><meta name="description" content="Twirp is a simple RPC framework built on"/><meta name="docsearch:language" content="en"/><meta property="og:title" content="Meet Twirp! · Twirp"/><meta property="og:type" content="website"/><meta property="og:url" content="https://twitchtv.github.io/twirp/index.html"/><meta property="og:description" content="Twirp is a simple RPC framework built on"/><meta name="twitter:card" content="summary"/><link rel="shortcut icon" href="/twirp/undefined"/><link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/styles/tomorrow.min.css"/><script type="text/javascript" src="https://buttons.github.io/buttons.js"></script><script src="/twirp/js/scrollSpy.js"></script><link rel="stylesheet" href="/twirp/css/main.css"/><script src="/twirp/js/codetabs.js"></script></head><body class="sideNavVisible"><div class="fixedHeaderContainer"><div class="headerWrapper wrapper"><header><a href="/twirp/"><h2 class="headerTitle">Twirp</h2></a><div class="navigationWrapper navigationSlider"><nav class="slidingNav"><ul class="nav-site nav-site-internal"><li class="siteNavGroupActive siteNavItemActive"><a href="/twirp/docs/intro.html" target="_self">Docs</a></li><li class="siteNavGroupActive"><a href="/twirp/docs/spec_v7.html" target="_self">Spec</a></li></ul></nav></div></header></div></div><div class="navPusher"><div class="docMainWrapper wrapper"><div class="docsNavContainer" id="docsNav"><nav class="toc"><div class="toggleNav"><section class="navWrapper wrapper"><div class="navBreadcrumb wrapper"><div class="navToggle" id="navToggler"><div class="hamburger-menu"><div class="line1"></div><div class="line2"></div><div class="line3"></div></div></div><h2><i>›</i><span>Getting started</span></h2></div><div class="navGroups"><div class="navGroup"><h3 class="navGroupCategoryTitle">Getting started</h3><ul class=""><li class="navListItem navListItemActive"><a class="navItem" href="/twirp/docs/intro.html">Overview</a></li><li class="navListItem"><a class="navItem" href="/twirp/docs/install.html">Installation</a></li><li class="navListItem"><a class="navItem" href="/twirp/docs/example.html">Usage Example</a></li><li class="navListItem"><a class="navItem" href="/twirp/docs/best_practices.html">Best Practices</a></li></ul></div><div class="navGroup"><h3 class="navGroupCategoryTitle">Beyond the basics</h3><ul class=""><li class="navListItem"><a class="navItem" href="/twirp/docs/routing.html">Routing and Serialization</a></li><li class="navListItem"><a class="navItem" href="/twirp/docs/errors.html">Errors</a></li><li class="navListItem"><a class="navItem" href="/twirp/docs/proto_and_json.html">Protobuf and JSON</a></li><li class="navListItem"><a class="navItem" href="/twirp/docs/hooks.html">Hooks and Interceptors</a></li><li class="navListItem"><a class="navItem" href="/twirp/docs/mux.html">Muxing Twirp services</a></li><li class="navListItem"><a class="navItem" href="/twirp/docs/headers.html">Custom HTTP Headers</a></li><li class="navListItem"><a class="navItem" href="/twirp/docs/command_line.html">Generator Flags</a></li><li class="navListItem"><a class="navItem" href="/twirp/docs/curl.html">cURL</a></li><li class="navListItem"><a class="navItem" href="/twirp/docs/migrate_to_twirp.html">Migrate APIs to Twirp</a></li><li class="navListItem"><a class="navItem" href="/twirp/docs/version_matrix.html">Version Compatibility</a></li></ul></div><div class="navGroup"><h3 class="navGroupCategoryTitle">Formal specification</h3><ul class=""><li class="navListItem"><a class="navItem" href="/twirp/docs/spec_v5.html">Version 5 (Previous)</a></li><li class="navListItem"><a class="navItem" href="/twirp/docs/spec_v6.html">Version 6 (Archived)</a></li><li class="navListItem"><a class="navItem" href="/twirp/docs/spec_v7.html">Version 7 (Current)</a></li></ul></div></div></section></div><script>
            var coll = document.getElementsByClassName('collapsible');
            var checkActiveCategory = true;
            for (var i = 0; i < coll.length; i++) {
              var links = coll[i].nextElementSibling.getElementsByTagName('*');
              if (checkActiveCategory){
                for (var j = 0; j < links.length; j++) {
                  if (links[j].classList.contains('navListItemActive')){
                    coll[i].nextElementSibling.classList.toggle('hide');
                    coll[i].childNodes[1].classList.toggle('rotate');
                    checkActiveCategory = false;
                    break;
                  }
                }
              }

              coll[i].addEventListener('click', function() {
                var arrow = this.childNodes[1];
                arrow.classList.toggle('rotate');
                var content = this.nextElementSibling;
                content.classList.toggle('hide');
              });
            }

            document.addEventListener('DOMContentLoaded', function() {
              createToggler('#navToggler', '#docsNav', 'docsSliderActive');
              createToggler('#tocToggler', 'body', 'tocActive');

              var headings = document.querySelector('.toc-headings');
              headings && headings.addEventListener('click', function(event) {
                var el = event.target;
                while(el !== headings){
                  if (el.tagName === 'A') {
                    document.body.classList.remove('tocActive');
                    break;
                  } else{
                    el = el.parentNode;
                  }
                }
              }, false);

              function createToggler(togglerSelector, targetSelector, className) {
                var toggler = document.querySelector(togglerSelector);
                var target = document.querySelector(targetSelector);

                if (!toggler) {
                  return;
                }

                toggler.onclick = function(event) {
                  event.preventDefault();

                  target.classList.toggle(className);
                };
              }
            });
        </script></nav></div><div class="container mainContainer docsContainer"><div class="wrapper"><div class="post"><header class="postHeader"><h1 id="__docusaurus" class="postHeaderTitle">Meet Twirp!</h1></header><article><div><span><p>Twirp is a simple RPC framework built on
<a href="https://developers.google.com/protocol-buffers/">protobuf</a>. You define a
service in a <code>.proto</code> specification file, then Twirp will <em>generate</em> servers and
clients for that service. It's your job to fill in the &quot;business logic&quot; that
powers the server, and then generated clients can consume your service straight
away.</p>
<p>This doc is an overview of how you use Twirp - how you interact with it, what
you write, and what it generates. Using the Go implementation as example: <a href="https://github.com/twitchtv/twirp">https://github.com/twitchtv/twirp</a></p>
<h2><a class="anchor" aria-hidden="true" id="making-a-twirp-service-in-go"></a><a href="#making-a-twirp-service-in-go" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Making a Twirp Service in Go</h2>
<p>To make a Twirp service:</p>
<ol>
<li>Define your service in a <strong>Proto</strong> file.</li>
<li>Use the <code>protoc</code> command to generate go code from the <strong>Proto</strong> file, it
will generate an <strong>interface</strong>, a <strong>client</strong> and some <strong>server utils</strong> (to
easily start an http listener).</li>
<li>Implement the generated <strong>interface</strong> to implement the service.</li>
</ol>
<p>For example, a HelloWorld <strong>Proto</strong> file:</p>
<pre><code class="hljs css language-protobuf">syntax = <span class="hljs-string">"proto3"</span>;
<span class="hljs-keyword">package</span> example.com.my.<span class="hljs-keyword">package</span>.helloworld;
<span class="hljs-keyword">option</span> go_package = <span class="hljs-string">"example.com/my/package/helloworld"</span>;

<span class="hljs-class"><span class="hljs-keyword">service</span> <span class="hljs-title">HelloWorld</span> </span>{
  <span class="hljs-function"><span class="hljs-keyword">rpc</span> Hello(HelloReq) <span class="hljs-keyword">returns</span> (HelloResp)</span>;
}

<span class="hljs-class"><span class="hljs-keyword">message</span> <span class="hljs-title">HelloReq</span> </span>{
  <span class="hljs-built_in">string</span> subject = <span class="hljs-number">1</span>;
}

<span class="hljs-class"><span class="hljs-keyword">message</span> <span class="hljs-title">HelloResp</span> </span>{
  <span class="hljs-built_in">string</span> text = <span class="hljs-number">1</span>;
}
</code></pre>
<p>Running the <code>protoc</code> compiler with the <code>--go_out</code> and <code>--twirp_out</code> options will generate <code>.pb.go</code> and <code>.twirp.go</code> files. The Twirp file contains this <strong>interface</strong>:</p>
<pre><code class="hljs css language-go"><span class="hljs-keyword">type</span> HelloWorld <span class="hljs-keyword">interface</span> {
    Hello(context.Context, *HelloReq) (*HelloResp, error)
}
</code></pre>
<p>You provide the <strong>implementation</strong>:</p>
<pre><code class="hljs css language-go"><span class="hljs-keyword">package</span> main

<span class="hljs-keyword">import</span> (
    <span class="hljs-string">"context"</span>
    <span class="hljs-string">"net/http"</span>

    pb <span class="hljs-string">"github.com/twitchtv/twirp-example/rpc/helloworld"</span>
)

<span class="hljs-keyword">type</span> HelloWorldServer <span class="hljs-keyword">struct</span>{}

<span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-params">(s *HelloWorldServer)</span> <span class="hljs-title">Hello</span><span class="hljs-params">(ctx context.Context, req *pb.HelloReq)</span> <span class="hljs-params">(*pb.HelloResp, error)</span></span> {
    <span class="hljs-keyword">return</span> &amp;pb.HelloResp{Text: <span class="hljs-string">"Hello "</span> + req.Subject}, <span class="hljs-literal">nil</span>
}

<span class="hljs-comment">// Run the implementation in a local server</span>
<span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-title">main</span><span class="hljs-params">()</span></span> {
    twirpHandler := pb.NewHelloWorldServer(&amp;HelloWorldServer{})
    <span class="hljs-comment">// You can use any mux you like - NewHelloWorldServer gives you an http.Handler.</span>
    mux := http.NewServeMux()
    <span class="hljs-comment">// The generated code includes a method, PathPrefix(), which</span>
    <span class="hljs-comment">// can be used to mount your service on a mux.</span>
    mux.Handle(twirpHandler.PathPrefix(), twirpHandler)
    http.ListenAndServe(<span class="hljs-string">":8080"</span>, mux)
}
</code></pre>
<p>And voila! Now you can use the auto-generated <strong>Client</strong> to make remote calls to your new service:</p>
<pre><code class="hljs css language-go"><span class="hljs-keyword">package</span> main

<span class="hljs-keyword">import</span> (
    <span class="hljs-string">"context"</span>
    <span class="hljs-string">"fmt"</span>
    <span class="hljs-string">"net/http"</span>

    pb <span class="hljs-string">"github.com/twitchtv/twirp-example/rpc/helloworld"</span>
)

<span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-title">main</span><span class="hljs-params">()</span></span> {
    client := pb.NewHelloWorldProtobufClient(<span class="hljs-string">"http://localhost:8080"</span>, &amp;http.Client{})

    resp, err := client.Hello(context.Background(), &amp;pb.HelloReq{Subject: <span class="hljs-string">"World"</span>})
    <span class="hljs-keyword">if</span> err == <span class="hljs-literal">nil</span> {
        fmt.Println(resp.Text) <span class="hljs-comment">// prints "Hello World"</span>
    }
}
</code></pre>
<h2><a class="anchor" aria-hidden="true" id="why-this-is-good"></a><a href="#why-this-is-good" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Why this is good</h2>
<p>Twirp <a href="/twirp/docs/routing.html">routing and serialization</a> reduces the risk
of introducing bugs. Both JSON and Protobuf are supported. The
<a href="https://developers.google.com/protocol-buffers/docs/proto3">Protobuf protocol</a>
is designed to allow backwards compatible changes (unlike JSON, it is trivial to
rename fields). Protobuf is super fast and the proto file definition
also works well as documentation for your service.</p>
<h2><a class="anchor" aria-hidden="true" id="whats-next"></a><a href="#whats-next" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>What's next?</h2>
<ul>
<li><a href="/twirp/docs/install.html">Install Twirp</a>: instructions to install or upgrade Twirp tools
for code auto-generation (protoc, protoc-gen-go and protoc-gen-twirp).</li>
<li><a href="/twirp/docs/example.html">Usage Example</a>: step by step guide to build an awesome
Haberdasher service.</li>
<li><a href="/twirp/docs/routing.html">How Twirp routes requests</a>: learn more about how Twirp works
under the covers.</li>
</ul>
</span></div></article></div><div class="docs-prevnext"><a class="docs-next button" href="/twirp/docs/install.html"><span>Installation</span><span class="arrow-next"> →</span></a></div></div></div></div><footer class="nav-footer" id="footer"><section class="copyright">Copyright © 2022 Twitch Interactive, Inc.</section></footer></div></body></html>